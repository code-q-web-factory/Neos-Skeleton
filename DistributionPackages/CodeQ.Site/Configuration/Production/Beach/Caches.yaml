##
#
# Flownative Beach Cache Configuration for Redis
#
# We are using a optimized cache backend here, because our content is too big,
# that we often ran into cache issues.
#
# See also https://support.flownative.com/#ticket/zoom/5321
# and https://github.com/neos/flow-development-collection/issues/2483
#
##

Flow_Mvc_Routing_Route:
  backend: 'Sandstorm\OptimizedRedisCacheBackend\OptimizedRedisCacheBackend'
  backendOptions:
    hostname: '%env:BEACH_REDIS_HOST%'
    password: '%env:BEACH_REDIS_PASSWORD%'
    port: '6379'
    # starting with database 2 here, since 0 and 1 are used and flushed by
    # the core unit tests and should not be used if possible.
    database: 2
    defaultLifetime: 0

Flow_Mvc_Routing_Resolve:
  backend: 'Sandstorm\OptimizedRedisCacheBackend\OptimizedRedisCacheBackend'
  backendOptions:
    hostname: '%env:BEACH_REDIS_HOST%'
    password: '%env:BEACH_REDIS_PASSWORD%'
    port: '6379'
    database: 3
    defaultLifetime: 0

Neos_Fusion_Content:
  backend: 'Sandstorm\OptimizedRedisCacheBackend\OptimizedRedisCacheBackend'
  backendOptions:
    hostname: '%env:BEACH_REDIS_HOST%'
    password: '%env:BEACH_REDIS_PASSWORD%'
    port: '6379'
    database: 4
    defaultLifetime: 0

Neos_Media_ImageSize:
  backend: 'Sandstorm\OptimizedRedisCacheBackend\OptimizedRedisCacheBackend'
  backendOptions:
    hostname: '%env:BEACH_REDIS_HOST%'
    password: '%env:BEACH_REDIS_PASSWORD%'
    port: '6379'
    database: 7
    defaultLifetime: 0

##
#
# In Flownative Beach we have two replicas
#
##
Flow_Session_MetaData: &pdoBackend
  backend: 'Neos\Cache\Backend\PdoBackend'
  backendOptions:
    dataSourceName: 'mysql:host=%env:BEACH_DATABASE_HOST%;dbname=%env:BEACH_DATABASE_NAME%'
    username: '%env:BEACH_DATABASE_USERNAME%'
    password: '%env:BEACH_DATABASE_PASSWORD%'
    defaultLifetime: 0

Flow_Session_Storage: *pdoBackend
Flow_Security_Cryptography_RSAWallet: *pdoBackend
Flow_Security_Cryptography_HashService: *pdoBackend
Neos_GoogleApiClient_Credentials: *pdoBackend
